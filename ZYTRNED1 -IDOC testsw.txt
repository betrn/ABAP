REPORT ZTVDA000 .

parameters: p_idoc like edidc-docnum default '208054'.

data: begin of wt_upload occurs 0,
        line(900),
      end of wt_upload.
data: it_edidd like edidd occurs 0 with header line,
      it_edids like BDIDOCSTAT
 occurs 0 with header line,
      it_edidc like edidc occurs 0 with header line,
      it_ret   like BDWFRETVAR occurs 0 with header line,
      it_ser   like BDI_SER
 occurs 0 with header line.

CALL FUNCTION 'IDOC_READ_COMPLETELY'
     EXPORTING
          DOCUMENT_NUMBER = p_idoc
     IMPORTING
          IDOC_CONTROL    = it_edidc
     TABLES
          INT_EDIDD       = it_edidd.
*write: sy-subrc.
*append it_edidc.
uline.
write: / it_edidc(100).
loop at it_edidd.
  write: / it_edidd(100).
endloop.
uline.

CALL FUNCTION 'UPLOAD'
* EXPORTING
*   CODEPAGE                      = ' '
*   FILENAME                      = ' '
*   FILETYPE                      = ' '
*   ITEM                          = ' '
*   FILEMASK_MASK                 = ' '
*   FILEMASK_TEXT                 = ' '
*   FILETYPE_NO_CHANGE            = ' '
*   FILEMASK_ALL                  = ' '
*   FILETYPE_NO_SHOW              = ' '
*   LINE_EXIT                     = ' '
*   USER_FORM                     = ' '
*   USER_PROG                     = ' '
*   SILENT                        = 'S'
* IMPORTING
*   FILESIZE                      =
*   CANCEL                        =
*   ACT_FILENAME                  =
*   ACT_FILETYPE                  =
  TABLES
    DATA_TAB                      = wt_upload
* EXCEPTIONS
*   CONVERSION_ERROR              = 1
*   INVALID_TABLE_WIDTH           = 2
*   INVALID_TYPE                  = 3
*   NO_BATCH                      = 4
*   UNKNOWN_ERROR                 = 5
*   GUI_REFUSE_FILETRANSFER       = 6
*   OTHERS                        = 7
          .
IF SY-SUBRC <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
ENDIF.
refresh: it_edidc,
         it_edidd.

loop at wt_upload.
  write: / wt_upload-line.
  case wt_upload-line(3).
    when 'EDI'.
      move wt_upload-line to it_edidc.
      append it_edidc.
    when others.
      move wt_upload-line to it_edidd.
      append it_edidd.
  endcase.
endloop.

CALL FUNCTION 'IDOC_INPUT_RESEND'
     EXPORTING
          INPUT_METHOD       = ' '
          MASS_PROCESSING    = ' '
     TABLES
          IDOC_CONTRL        = it_edidc
          IDOC_DATA          = it_edidd
          IDOC_STATUS        = it_edids
          RETURN_VARIABLES   = it_ret
          SERIALIZATION_INFO = it_ser.

write: sy-subrc.
